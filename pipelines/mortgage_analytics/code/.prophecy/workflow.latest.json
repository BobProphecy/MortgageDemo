{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1"
    },
    "codeGenConfiguration" : {
      "editableConfig" : true
    },
    "id" : "1",
    "uri" : "pipelines/mortgage_analytics",
    "language" : "python",
    "fabricId" : "9631",
    "frontEndLanguage" : "sql",
    "mode" : "batch",
    "udfs" : {
      "language" : "python",
      "udfs" : [ ],
      "functionPackageName" : "bobwprophecyioteam.mortgageanalytics.functions",
      "sharedFunctionPackageNames" : [ "prophecy.spark_basic.functions", "prophecy.warehouse.functions" ]
    },
    "udafs" : {
      "language" : "python",
      "code" : ""
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "12654",
      "projectName" : "ProphecySparkBasicsPython",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12655",
      "projectName" : "ProphecyWarehousePython",
      "externalDependencies" : [ ]
    } ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "topLevelPackage" : "mortgage_analytics",
    "configurationVersion" : "v1"
  },
  "connections" : [ {
    "id" : "gySM67KyjzQ6ZRgumeIfS$$HEbUrKCRYlxuWUywCzXSB",
    "source" : "4kqI7vslqwZUkg8g5eiyi$$IuxlRqsVksOhU3snnAewR",
    "sourcePort" : "du2xrdKnRybrrvOjZxmF0$$XxzDtzgsC3ECLIamUQMux",
    "target" : "7Qe6Ojpmv08DrC-pQ1buf$$-Xzq8vMnY51Qffb4zykXK",
    "targetPort" : "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb"
  }, {
    "id" : "-Az4nCn0yIoE0dIxQ-ifo$$R87zAu9IhkTHulaGiL4fa",
    "source" : "zyoB6ezFKyy2O8-m5hJvG$$bIf2_Q-tpYvZTjzMwyryh",
    "sourcePort" : "_tUYWfc_JdpLPSS2GrE7y$$qyetxMr4IlCCNTrvkMFq-",
    "target" : "ZO7G2UhdBKI8k_hpi7lN-$$23vqYRsVvpCezf8DIUjX5",
    "targetPort" : "vtE-551HrOh8kevuUVU76$$ZTF-Yj49IXIHH3zoaibC5"
  }, {
    "id" : "uwWsmWVZnApn6C4hixbMU$$gn57T-9VNWmx7RkNU1za4",
    "source" : "7Qe6Ojpmv08DrC-pQ1buf$$-Xzq8vMnY51Qffb4zykXK",
    "sourcePort" : "nyjDOYiX8_vMLdFtqkT8n$$_0QHxUyPHG-THBMBoBO2D",
    "target" : "ZO7G2UhdBKI8k_hpi7lN-$$23vqYRsVvpCezf8DIUjX5",
    "targetPort" : "dWF6Ikvs58_Zu0XnBt7Dc$$Irnih8j2WBComCA9d7K5l"
  }, {
    "id" : "sCGiEHLAAycmTndI_7Ear$$zBNRLuZyf38NP9fLNbY-P",
    "source" : "ZO7G2UhdBKI8k_hpi7lN-$$23vqYRsVvpCezf8DIUjX5",
    "sourcePort" : "XLr2InMU5ukHlykZIrw7R$$gVuAd3yrm9sN1pNTW79yR",
    "target" : "J4KACe_tc8QAvbktuvrHE$$gJWKp5QW9QFbf6RvDhewp",
    "targetPort" : "GPli3i2ynwMDiwapJigxr$$EPevQYa7pCNS9FhR5t9Io"
  }, {
    "id" : "8PRS0Fae1ok0niKMYKIe5$$PVGEZ0prWgFkOsvypX0Wx",
    "source" : "J4KACe_tc8QAvbktuvrHE$$gJWKp5QW9QFbf6RvDhewp",
    "sourcePort" : "xw5FE_hiOkzi7KuNcRLli$$uczrFSqV5sDgXQGv_ZWoF",
    "target" : "BTIAO4TE3ms-mY3Hm2i6X$$WqSCbssnK4tNct2DQixoG",
    "targetPort" : "72QUuM2T98XIP6g4hZGae$$4xCBJnx_Z4NOLwhWmAIXz"
  }, {
    "id" : "8OMvir6zJxF6nOIvNJdda",
    "source" : "J4KACe_tc8QAvbktuvrHE$$gJWKp5QW9QFbf6RvDhewp",
    "sourcePort" : "xw5FE_hiOkzi7KuNcRLli$$uczrFSqV5sDgXQGv_ZWoF",
    "target" : "Xac5yWT3TYIwYSO-z0gkP$$2r2d29Sz5-lOdc_byv7DO",
    "targetPort" : "m6x1XVlcTpONq5WjOM0Bp$$aXSKyDewXHXD475Z2IWZ9"
  }, {
    "id" : "GQ2HZPgYMiDI0iRJBTi9V$$8mg4ZFpPE6tYydrw4OTLC",
    "source" : "Xac5yWT3TYIwYSO-z0gkP$$2r2d29Sz5-lOdc_byv7DO",
    "sourcePort" : "LuraPjlDoh4L3vy7OronX$$iPXh4ldDVWY5z2ehZhwi6",
    "target" : "mW-g83NrpPVighsoM3P8q$$q1WAndja8Emj-d6mARuUy",
    "targetPort" : "pLOrTpxg_HWt9ZcgX3Ql6$$FUs_v0Y-iO52AOWoViL5H"
  }, {
    "id" : "QEwvoxbvYOT3zQBn5Lj8T$$2aiaF2I1aT1wdOLKzqKG7",
    "source" : "mW-g83NrpPVighsoM3P8q$$q1WAndja8Emj-d6mARuUy",
    "sourcePort" : "z6HBl7WXxR9mCNM8mNMpO$$HMlkZMWonJMQR5h2BVwnj",
    "target" : "BZX62pq8yvJwIBIgbHSb8$$iF9TZK2cLuau6729CqEoZ",
    "targetPort" : "KP-wptQOdFsIhNQC2jgCb$$a8yvtL07Dvb0DKaf4_CZA"
  }, {
    "id" : "MWn6mmL8YW1nmF-d6saSO$$PKkTwDDP4hXwljWZzgh5b",
    "source" : "BZX62pq8yvJwIBIgbHSb8$$iF9TZK2cLuau6729CqEoZ",
    "sourcePort" : "LzVVQnSuK-kjt2WL-25qb$$zGk2d77M0HDEGF8LZrI7d",
    "target" : "hOXppsb1yhNdDEvHddY5q$$gGXPXzbmLGwEMUmO3gToo",
    "targetPort" : "_KnDRMCrhD5B_hg7PK9e1$$CkimCwsNNOcllk3Ubefoe"
  }, {
    "id" : "2teJBDm0CMPJynN9iMzCm",
    "source" : "Xac5yWT3TYIwYSO-z0gkP$$2r2d29Sz5-lOdc_byv7DO",
    "sourcePort" : "LuraPjlDoh4L3vy7OronX$$iPXh4ldDVWY5z2ehZhwi6",
    "target" : "2gL1LRLfPj0GCASqLZrff$$6t2dXNLZdNJk_ubxuhmNU",
    "targetPort" : "gqPsNtlV07txa56ZxrjmN$$lJMgVXGVN0vNp52I4Q83z"
  } ],
  "processes" : {
    "BZX62pq8yvJwIBIgbHSb8$$iF9TZK2cLuau6729CqEoZ" : {
      "id" : "BZX62pq8yvJwIBIgbHSb8$$iF9TZK2cLuau6729CqEoZ",
      "component" : "OrderBy",
      "metadata" : {
        "label" : "sort_by_state",
        "slug" : "sort_by_state",
        "x" : 1320,
        "y" : 120,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This gem sorts the average unpaid balance to property value ratio by state in descending order. This could help identify states with higher risk of default or foreclosure, and inform business decisions related to mortgage lending and risk management."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "KP-wptQOdFsIhNQC2jgCb$$a8yvtL07Dvb0DKaf4_CZA",
          "slug" : "avg_upb_to_value_ratio_by_state",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "State",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "prop_count",
              "type" : "long",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UPB_to_Value_Ratio",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "LzVVQnSuK-kjt2WL-25qb$$zGk2d77M0HDEGF8LZrI7d",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ "KP-wptQOdFsIhNQC2jgCb$$a8yvtL07Dvb0DKaf4_CZA##prop_count" ],
        "orders" : [ {
          "expression" : {
            "format" : "sql",
            "expression" : "prop_count"
          },
          "sortType" : "desc"
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.4&projectSubscriptionProjectId=12654&path=gems/OrderBy",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "7Qe6Ojpmv08DrC-pQ1buf$$-Xzq8vMnY51Qffb4zykXK" : {
      "id" : "7Qe6Ojpmv08DrC-pQ1buf$$-Xzq8vMnY51Qffb4zykXK",
      "component" : "Reformat",
      "metadata" : {
        "label" : "clean_up_mortgage_west",
        "slug" : "clean_up_mortgage_west",
        "x" : 320,
        "y" : 420,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This gem cleans up mortgage data for the western region by selecting relevant columns and renaming them for better readability. It also creates a new column called LoanStatus which categorizes loans based on their delinquency status (0, 30, 60, 90, REO). This could help business users understand the current state of the loans and prioritize their efforts accordingly."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Account",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifier for each mortgage account. It stores values of string data type and provides a way to uniquely identify each mortgage account in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "City",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the city where the property associated with the mortgage is located. This column stores values of string data type and provides information about the geographical location of the property.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "State",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The state in which the property associated with the mortgage is located. This column stores values of string data type and provides information about the geographical location of the property.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Property Type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the type of property associated with each mortgage account. It stores values of string data type, providing information about the nature of the property, such as whether it is a single-family home, a condominium, or a commercial property.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Servicer",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the company or organization responsible for servicing the mortgage loan. This column stores string values and provides information about the entity responsible for collecting payments, managing the loan, and handling any issues related to the mortgage.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Servicer Type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "This column represents the type of servicer responsible for managing the mortgage loan. It stores categorical values in string data type, indicating the type of organization that services the loan, such as a bank or a mortgage company. This information can be useful in understanding the management and servicing of the mortgage loan.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Loan Type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the type of loan taken by the borrower. It stores categorical values in string data type, providing information about the terms and conditions of the loan, such as fixed or adjustable interest rates, loan duration, and payment schedule.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UnPaid Balance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The outstanding balance on a mortgage loan. This column stores the monetary value of the remaining balance on a mortgage loan that has not yet been paid off. The values in this column are of string data type and represent the amount of money owed by the borrower to the lender.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "0",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "This column represents the number of days that a mortgage payment is overdue by 0 days. It stores numerical values in string data type, indicating the number of mortgages that are current and up to date with their payments.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "30",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Represents the number of days past due for a mortgage payment. It stores numerical values in string data type, indicating the number of days that a payment is overdue. A value of '30' in this column indicates that the payment is 30 days past due.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "60",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "Represents the number of days a mortgage payment is overdue by 60 days or more. It stores numerical values in string data type, indicating the number of days a customer has missed their mortgage payment by 60 days or more. This column provides insight into the financial health of the mortgage portfolio and the likelihood of default by customers.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "90",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "This column represents the number of days that a mortgage payment is overdue by 90 days or more. It stores numerical values in string data type, indicating the number of days that a borrower has failed to make a payment. This column is important for assessing the risk of default on a mortgage loan.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "REO",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "REO stands for Real Estate Owned and refers to properties that have been foreclosed and are now owned by the mortgage lender. This column stores a binary value indicating whether a property is an REO or not. A value of 1 indicates that the property is an REO, while a value of 0 indicates that it is not.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Current Prop Value",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "This column represents the current market value of the property associated with each mortgage account. It stores numerical values in string data type, indicating the estimated worth of the property at the time of data collection. This value is subject to change over time due to fluctuations in the real estate market.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LTV",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "LTV stands for Loan-to-Value ratio and represents the ratio of the loan amount to the appraised value of the property. It is expressed as a percentage and is used to determine the risk associated with a mortgage loan. This column stores numerical values in string data type, indicating the LTV ratio for each mortgage loan.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Avg OEP",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "This column represents the average occupancy expense per unit. It stores numerical values and provides insight into the average cost of maintaining and operating each unit in the property. The values in this column are of string data type.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Unemployment",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Represents the unemployment rate in the area where the property is located. It stores numerical values in string data type, indicating the percentage of unemployed individuals in the region. This column provides insight into the economic conditions of the area and can be used to analyze the impact of unemployment on mortgage defaults and foreclosures.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Avg Values",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "This column represents the average value of properties in the area where the mortgage is held. It stores numerical values in string data type, indicating the average property value in the region. This information can be useful in determining the overall value of the mortgage portfolio and assessing the risk associated with it.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Inventory",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Inventory refers to the number of properties that are currently owned by the mortgage company. It stores numerical values and provides an insight into the company's current holdings. The values in this column are of string data type.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Days on Market",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The number of days a property has been listed on the market. This column stores numerical values and provides insight into the length of time it takes for a property to sell. It is an important metric for real estate professionals and investors to track market trends and property values.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "nyjDOYiX8_vMLdFtqkT8n$$_0QHxUyPHG-THBMBoBO2D",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
        "expressions" : [ {
          "target" : "PropID",
          "expression" : {
            "format" : "sql",
            "expression" : "Account"
          },
          "description" : ""
        }, {
          "target" : "City",
          "expression" : {
            "format" : "sql",
            "expression" : "City"
          },
          "description" : ""
        }, {
          "target" : "State",
          "expression" : {
            "format" : "sql",
            "expression" : "initcap(State)"
          },
          "description" : ""
        }, {
          "target" : "PropertyType",
          "expression" : {
            "format" : "sql",
            "expression" : "`Property Type`"
          },
          "description" : ""
        }, {
          "target" : "Servicer",
          "expression" : {
            "format" : "sql",
            "expression" : "Servicer"
          },
          "description" : ""
        }, {
          "target" : "ServicerType",
          "expression" : {
            "format" : "sql",
            "expression" : "`Servicer Type`"
          },
          "description" : ""
        }, {
          "target" : "LoanType",
          "expression" : {
            "format" : "sql",
            "expression" : "`Loan Type`"
          },
          "description" : ""
        }, {
          "target" : "UnPaidBalance",
          "expression" : {
            "format" : "sql",
            "expression" : "`UnPaid Balance`"
          },
          "description" : ""
        }, {
          "target" : "CurrentPropValue",
          "expression" : {
            "format" : "sql",
            "expression" : "`Current Prop Value`"
          },
          "description" : ""
        }, {
          "target" : "LoanStatus",
          "expression" : {
            "format" : "sql",
            "expression" : "CASE WHEN (`0` > 0) THEN '0' WHEN (`30` > 0) THEN '30' WHEN (`60` > 0) THEN '60' WHEN (`90` > 0) THEN '90' WHEN (REO > 0) THEN 'REO' END"
          },
          "description" : ""
        } ],
        "importString" : "",
        "activeTab" : "expressions",
        "columnsSelector" : [ "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##City", "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##30", "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##90", "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##0", "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##UnPaid Balance", "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##REO", "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##60", "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##Current Prop Value", "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##Servicer", "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##Property Type", "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##State", "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##Account", "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##Servicer Type", "kcqOS91VQCg4XBfUdjQyK$$OkJWR3PbMGLNdjjCpLqrb##Loan Type" ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.4&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "BTIAO4TE3ms-mY3Hm2i6X$$WqSCbssnK4tNct2DQixoG" : {
      "id" : "BTIAO4TE3ms-mY3Hm2i6X$$WqSCbssnK4tNct2DQixoG",
      "component" : "Target",
      "metadata" : {
        "label" : "tbl_all_mortgages",
        "slug" : "tbl_all_mortgages",
        "x" : 920,
        "y" : 420,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This gem saves the input DataFrame as a Delta table named \"mortgages_all\" in the \"mortgage_demo\" database under the \"bobwelshmer\" user. This could be useful for data persistence and sharing across different Spark applications or for querying the data using SQL."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "72QUuM2T98XIP6g4hZGae$$4xCBJnx_Z4NOLwhWmAIXz",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PropID",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifier for each property in the dataset. It stores alphanumeric values in string data type, providing a way to uniquely identify each property in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "City",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the city where the property is located. This column stores values of string data type and provides information about the geographical location of the property.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "State",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PropertyType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Specifies the type of property associated with each mortgage. It stores values of string data type, indicating whether the property is a single-family home, multi-family home, condominium, or other type of property. This column provides important information about the characteristics of the properties associated with each mortgage.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Servicer",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the company or organization that services the mortgage loan. This column stores string values and provides information about the entity responsible for managing the loan payments and other related activities.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ServicerType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the type of servicer responsible for managing the mortgage loan. The values in this column are of string data type and provide information about the organization or entity responsible for servicing the loan, such as a bank or mortgage company. This column can be used to track the performance of different types of servicers and their impact on loan status and other metrics.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Specifies the type of loan associated with each property. It stores values of string data type, indicating the type of loan taken by the property owner. This column provides information about the terms and conditions of the loan, such as interest rates and payment schedules.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UnPaidBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The outstanding balance on the mortgage loan for a particular property. This column stores numerical values in double data type, indicating the amount of money that the borrower still owes on their mortgage loan. It is an important metric for lenders to assess the risk associated with a particular loan.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CurrentPropValue",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The current market value of the property associated with the mortgage. This column stores numerical values in double data type, indicating the estimated worth of the property at the time of data collection. It provides an insight into the value of the property and its potential for generating revenue.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanStatus",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the current status of the loan associated with the property. The values in this column are of string data type and provide information on whether the loan is in good standing, delinquent, or in default. This column is important for tracking the overall health of the mortgage portfolio.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UPB_to_Value_Ratio",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/tar_all_mortgages"
      }
    },
    "2gL1LRLfPj0GCASqLZrff$$6t2dXNLZdNJk_ubxuhmNU" : {
      "id" : "2gL1LRLfPj0GCASqLZrff$$6t2dXNLZdNJk_ubxuhmNU",
      "component" : "Target",
      "metadata" : {
        "label" : "tbl_troubled_mortgages",
        "slug" : "tbl_troubled_mortgages",
        "x" : 1140,
        "y" : 300,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This gem saves the input DataFrame as a Delta table named \"troubled_mortgages\" in the \"mortgage_demo\" database under the \"bobwelshmer\" user. This could be used for data persistence and sharing across different Spark applications or for downstream analytics and reporting."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "gqPsNtlV07txa56ZxrjmN$$lJMgVXGVN0vNp52I4Q83z",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PropID",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifier for each property in the dataset. It stores alphanumeric values in string data type, providing a way to uniquely identify each property in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "City",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the city where the property is located. This column stores values of string data type and provides information about the geographical location of the property.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "State",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PropertyType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Specifies the type of property associated with each mortgage. It stores values of string data type, indicating whether the property is a single-family home, multi-family home, condominium, or other type of property. This column provides important information about the characteristics of the properties associated with each mortgage.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Servicer",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the company or organization that services the mortgage loan. This column stores string values and provides information about the entity responsible for managing the loan payments and other related activities.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ServicerType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the type of servicer responsible for managing the mortgage loan. The values in this column are of string data type and provide information about the organization or entity responsible for servicing the loan, such as a bank or mortgage company. This column can be used to track the performance of different types of servicers and their impact on loan status and other metrics.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Specifies the type of loan associated with each property. It stores values of string data type, indicating the type of loan taken by the property owner. This column provides information about the terms and conditions of the loan, such as interest rates and payment schedules.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UnPaidBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The outstanding balance on the mortgage loan for a particular property. This column stores numerical values in double data type, indicating the amount of money that the borrower still owes on their mortgage loan. It is an important metric for lenders to assess the risk associated with a particular loan.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CurrentPropValue",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The current market value of the property associated with the mortgage. This column stores numerical values in double data type, indicating the estimated worth of the property at the time of data collection. It provides an insight into the value of the property and its potential for generating revenue.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanStatus",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the current status of the loan associated with the property. The values in this column are of string data type and provide information on whether the loan is in good standing, delinquent, or in default. This column is important for tracking the overall health of the mortgage portfolio.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UPB_to_Value_Ratio",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/tar_troubled_mortgages"
      }
    },
    "hOXppsb1yhNdDEvHddY5q$$gGXPXzbmLGwEMUmO3gToo" : {
      "id" : "hOXppsb1yhNdDEvHddY5q$$gGXPXzbmLGwEMUmO3gToo",
      "component" : "Target",
      "metadata" : {
        "label" : "csv_by_state_analysis",
        "slug" : "csv_by_state_analysis",
        "x" : 1520,
        "y" : 120,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This gem writes the input DataFrame to a CSV file with headers and a comma separator. The output file is saved to a specific location in the Databricks File System (DBFS) and overwrites any existing file with the same name. This could be useful for exporting data for further analysis or sharing with other teams or stakeholders."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "_KnDRMCrhD5B_hg7PK9e1$$CkimCwsNNOcllk3Ubefoe",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "State",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "prop_count",
              "type" : "long",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UPB_to_Value_Ratio",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/state_analysis_csv"
      }
    },
    "J4KACe_tc8QAvbktuvrHE$$gJWKp5QW9QFbf6RvDhewp" : {
      "id" : "J4KACe_tc8QAvbktuvrHE$$gJWKp5QW9QFbf6RvDhewp",
      "component" : "Reformat",
      "metadata" : {
        "label" : "calculations",
        "slug" : "calculations",
        "x" : 720,
        "y" : 320,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This gem performs calculations on a dataset containing information about properties and loans. It selects specific columns and calculates the ratio of unpaid balance to current property value. This ratio can be used to assess the risk associated with a loan and make informed decisions about loan servicing and management."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "GPli3i2ynwMDiwapJigxr$$EPevQYa7pCNS9FhR5t9Io",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PropID",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifier for each property in the dataset. It stores alphanumeric values in string data type, providing a way to uniquely identify each property in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "City",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the city where the property is located. This column stores values of string data type and provides information about the geographical location of the property.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "State",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The state in which the property is located. It stores the two-letter abbreviation of the state name and is of string data type. This column provides information about the geographic location of the property.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PropertyType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Specifies the type of property associated with each mortgage. It stores values of string data type, indicating whether the property is a single-family home, multi-family home, condominium, or other type of property. This column provides important information about the characteristics of the properties associated with each mortgage.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Servicer",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the company or organization that services the mortgage loan. This column stores string values and provides information about the entity responsible for managing the loan payments and other related activities.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ServicerType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the type of servicer responsible for managing the mortgage loan. The values in this column are of string data type and provide information about the organization or entity responsible for servicing the loan, such as a bank or mortgage company. This column can be used to track the performance of different types of servicers and their impact on loan status and other metrics.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Specifies the type of loan associated with each property. It stores values of string data type, indicating the type of loan taken by the property owner. This column provides information about the terms and conditions of the loan, such as interest rates and payment schedules.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UnPaidBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The outstanding balance on the mortgage loan for a particular property. This column stores numerical values in double data type, indicating the amount of money that the borrower still owes on their mortgage loan. It is an important metric for lenders to assess the risk associated with a particular loan.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CurrentPropValue",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The current market value of the property associated with the mortgage. This column stores numerical values in double data type, indicating the estimated worth of the property at the time of data collection. It provides an insight into the value of the property and its potential for generating revenue.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanStatus",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the current status of the loan associated with the property. The values in this column are of string data type and provide information on whether the loan is in good standing, delinquent, or in default. This column is important for tracking the overall health of the mortgage portfolio.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "xw5FE_hiOkzi7KuNcRLli$$uczrFSqV5sDgXQGv_ZWoF",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "importLanguage" : "${$.workflow.metainfo.frontEndLanguage}",
        "expressions" : [ {
          "target" : "PropID",
          "expression" : {
            "format" : "sql",
            "expression" : "PropID"
          },
          "description" : ""
        }, {
          "target" : "City",
          "expression" : {
            "format" : "sql",
            "expression" : "City"
          },
          "description" : ""
        }, {
          "target" : "State",
          "expression" : {
            "format" : "sql",
            "expression" : "initcap(State)"
          },
          "description" : ""
        }, {
          "target" : "PropertyType",
          "expression" : {
            "format" : "sql",
            "expression" : "PropertyType"
          },
          "description" : ""
        }, {
          "target" : "Servicer",
          "expression" : {
            "format" : "sql",
            "expression" : "Servicer"
          },
          "description" : ""
        }, {
          "target" : "ServicerType",
          "expression" : {
            "format" : "sql",
            "expression" : "ServicerType"
          },
          "description" : ""
        }, {
          "target" : "LoanType",
          "expression" : {
            "format" : "sql",
            "expression" : "LoanType"
          },
          "description" : ""
        }, {
          "target" : "UnPaidBalance",
          "expression" : {
            "format" : "sql",
            "expression" : "UnPaidBalance"
          },
          "description" : ""
        }, {
          "target" : "CurrentPropValue",
          "expression" : {
            "format" : "sql",
            "expression" : "CurrentPropValue"
          },
          "description" : ""
        }, {
          "target" : "LoanStatus",
          "expression" : {
            "format" : "sql",
            "expression" : "LoanStatus"
          },
          "description" : ""
        }, {
          "target" : "UPB_to_Value_Ratio",
          "expression" : {
            "format" : "sql",
            "expression" : "(UnPaidBalance / CurrentPropValue)"
          },
          "description" : ""
        } ],
        "importString" : "",
        "activeTab" : "expressions",
        "columnsSelector" : [ "GPli3i2ynwMDiwapJigxr$$EPevQYa7pCNS9FhR5t9Io##ServicerType", "GPli3i2ynwMDiwapJigxr$$EPevQYa7pCNS9FhR5t9Io##LoanStatus", "GPli3i2ynwMDiwapJigxr$$EPevQYa7pCNS9FhR5t9Io##CurrentPropValue", "GPli3i2ynwMDiwapJigxr$$EPevQYa7pCNS9FhR5t9Io##PropID", "GPli3i2ynwMDiwapJigxr$$EPevQYa7pCNS9FhR5t9Io##LoanType", "GPli3i2ynwMDiwapJigxr$$EPevQYa7pCNS9FhR5t9Io##Servicer", "GPli3i2ynwMDiwapJigxr$$EPevQYa7pCNS9FhR5t9Io##City", "GPli3i2ynwMDiwapJigxr$$EPevQYa7pCNS9FhR5t9Io##PropertyType", "GPli3i2ynwMDiwapJigxr$$EPevQYa7pCNS9FhR5t9Io##State", "GPli3i2ynwMDiwapJigxr$$EPevQYa7pCNS9FhR5t9Io##UnPaidBalance" ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.4&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "Xac5yWT3TYIwYSO-z0gkP$$2r2d29Sz5-lOdc_byv7DO" : {
      "id" : "Xac5yWT3TYIwYSO-z0gkP$$2r2d29Sz5-lOdc_byv7DO",
      "component" : "Filter",
      "metadata" : {
        "label" : "troubled_mortgages",
        "slug" : "troubled_mortgages",
        "x" : 920,
        "y" : 220,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This gem filters mortgage data to identify troubled mortgages based on a UPB to Value Ratio greater than 1 and a LoanStatus of either 90 or REO. This could help businesses identify high-risk mortgages and take appropriate actions to mitigate potential losses."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "m6x1XVlcTpONq5WjOM0Bp$$aXSKyDewXHXD475Z2IWZ9",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PropID",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifier for each property in the dataset. It stores alphanumeric values in string data type, providing a way to uniquely identify each property in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "City",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the city where the property is located. This column stores values of string data type and provides information about the geographical location of the property.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "State",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PropertyType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Specifies the type of property associated with each mortgage. It stores values of string data type, indicating whether the property is a single-family home, multi-family home, condominium, or other type of property. This column provides important information about the characteristics of the properties associated with each mortgage.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Servicer",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the company or organization that services the mortgage loan. This column stores string values and provides information about the entity responsible for managing the loan payments and other related activities.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ServicerType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the type of servicer responsible for managing the mortgage loan. The values in this column are of string data type and provide information about the organization or entity responsible for servicing the loan, such as a bank or mortgage company. This column can be used to track the performance of different types of servicers and their impact on loan status and other metrics.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Specifies the type of loan associated with each property. It stores values of string data type, indicating the type of loan taken by the property owner. This column provides information about the terms and conditions of the loan, such as interest rates and payment schedules.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UnPaidBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The outstanding balance on the mortgage loan for a particular property. This column stores numerical values in double data type, indicating the amount of money that the borrower still owes on their mortgage loan. It is an important metric for lenders to assess the risk associated with a particular loan.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CurrentPropValue",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The current market value of the property associated with the mortgage. This column stores numerical values in double data type, indicating the estimated worth of the property at the time of data collection. It provides an insight into the value of the property and its potential for generating revenue.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanStatus",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the current status of the loan associated with the property. The values in this column are of string data type and provide information on whether the loan is in good standing, delinquent, or in default. This column is important for tracking the overall health of the mortgage portfolio.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UPB_to_Value_Ratio",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "LuraPjlDoh4L3vy7OronX$$iPXh4ldDVWY5z2ehZhwi6",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ "m6x1XVlcTpONq5WjOM0Bp$$aXSKyDewXHXD475Z2IWZ9##UPB_to_Value_Ratio", "m6x1XVlcTpONq5WjOM0Bp$$aXSKyDewXHXD475Z2IWZ9##LoanStatus" ],
        "condition" : {
          "format" : "sql",
          "expression" : "UPB_to_Value_Ratio>1 AND LoanStatus IN (\"90\",\"REO\")"
        }
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.4&projectSubscriptionProjectId=12654&path=gems/Filter",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "ZO7G2UhdBKI8k_hpi7lN-$$23vqYRsVvpCezf8DIUjX5" : {
      "id" : "ZO7G2UhdBKI8k_hpi7lN-$$23vqYRsVvpCezf8DIUjX5",
      "component" : "SetOperation",
      "metadata" : {
        "label" : "union_east_west",
        "slug" : "union_east_west",
        "x" : 520,
        "y" : 320,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This gem combines two dataframes, in0 and in1, into a single dataframe by stacking them vertically. This could be useful for combining data from different sources or for appending new data to an existing dataframe."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "vtE-551HrOh8kevuUVU76$$ZTF-Yj49IXIHH3zoaibC5",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PropID",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifier for each property in the dataset. It stores alphanumeric values in string data type, providing a way to uniquely identify each property in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "City",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the city where the property is located. This column stores values of string data type and provides information about the geographical location of the property.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "State",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The state in which the property is located. It stores the two-letter abbreviation of the state name and is of string data type. This column provides information about the geographic location of the property.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PropertyType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Specifies the type of property associated with each mortgage. It stores values of string data type, indicating whether the property is a single-family home, multi-family home, condominium, or other type of property. This column provides important information about the characteristics of the properties associated with each mortgage.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Servicer",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the company or organization that services the mortgage loan. This column stores string values and provides information about the entity responsible for managing the loan payments and other related activities.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ServicerType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the type of servicer responsible for managing the mortgage loan. The values in this column are of string data type and provide information about the organization or entity responsible for servicing the loan, such as a bank or mortgage company. This column can be used to track the performance of different types of servicers and their impact on loan status and other metrics.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Specifies the type of loan associated with each property. It stores values of string data type, indicating the type of loan taken by the property owner. This column provides information about the terms and conditions of the loan, such as interest rates and payment schedules.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UnPaidBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The outstanding balance on the mortgage loan for a particular property. This column stores numerical values in double data type, indicating the amount of money that the borrower still owes on their mortgage loan. It is an important metric for lenders to assess the risk associated with a particular loan.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CurrentPropValue",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The current market value of the property associated with the mortgage. This column stores numerical values in double data type, indicating the estimated worth of the property at the time of data collection. It provides an insight into the value of the property and its potential for generating revenue.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanStatus",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the current status of the loan associated with the property. The values in this column are of string data type and provide information on whether the loan is in good standing, delinquent, or in default. This column is important for tracking the overall health of the mortgage portfolio.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "dWF6Ikvs58_Zu0XnBt7Dc$$Irnih8j2WBComCA9d7K5l",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PropID",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifier for each mortgage account. It stores values of string data type and provides a way to uniquely identify each mortgage account in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "City",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the city where the property associated with the mortgage is located. This column stores values of string data type and provides information about the geographical location of the property.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "State",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PropertyType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the type of property associated with each mortgage account. It stores values of string data type, providing information about the nature of the property, such as whether it is a single-family home, a condominium, or a commercial property.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Servicer",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the company or organization responsible for servicing the mortgage loan. This column stores string values and provides information about the entity responsible for collecting payments, managing the loan, and handling any issues related to the mortgage.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ServicerType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "This column represents the type of servicer responsible for managing the mortgage loan. It stores categorical values in string data type, indicating the type of organization that services the loan, such as a bank or a mortgage company. This information can be useful in understanding the management and servicing of the mortgage loan.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the type of loan taken by the borrower. It stores categorical values in string data type, providing information about the terms and conditions of the loan, such as fixed or adjustable interest rates, loan duration, and payment schedule.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UnPaidBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The outstanding balance on a mortgage loan. This column stores the monetary value of the remaining balance on a mortgage loan that has not yet been paid off. The values in this column are of string data type and represent the amount of money owed by the borrower to the lender.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CurrentPropValue",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "This column represents the current market value of the property associated with each mortgage account. It stores numerical values in string data type, indicating the estimated worth of the property at the time of data collection. This value is subject to change over time due to fluctuations in the real estate market.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanStatus",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "XLr2InMU5ukHlykZIrw7R$$gVuAd3yrm9sN1pNTW79yR",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "operationType" : "unionAll",
        "allowMissingColumns" : false
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.4&projectSubscriptionProjectId=12654&path=gems/SetOperation",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "mW-g83NrpPVighsoM3P8q$$q1WAndja8Emj-d6mARuUy" : {
      "id" : "mW-g83NrpPVighsoM3P8q$$q1WAndja8Emj-d6mARuUy",
      "component" : "Aggregate",
      "metadata" : {
        "label" : "avg_upb_to_value_ratio_by_state",
        "slug" : "avg_upb_to_value_ratio_by_state",
        "x" : 1120,
        "y" : 120,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This gem calculates the average UPB (unpaid principal balance) to value ratio for troubled mortgages by state. It also provides the count of properties in each state with troubled mortgages. This information can be used to identify areas with high mortgage default rates and to make informed decisions about risk management and investment strategies."
      },
      "ports" : {
        "inputs" : [ {
          "id" : "pLOrTpxg_HWt9ZcgX3Ql6$$FUs_v0Y-iO52AOWoViL5H",
          "slug" : "troubled_mortgages",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PropID",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Unique identifier for each property in the dataset. It stores alphanumeric values in string data type, providing a way to uniquely identify each property in the dataset.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "City",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the city where the property is located. This column stores values of string data type and provides information about the geographical location of the property.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "State",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PropertyType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Specifies the type of property associated with each mortgage. It stores values of string data type, indicating whether the property is a single-family home, multi-family home, condominium, or other type of property. This column provides important information about the characteristics of the properties associated with each mortgage.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Servicer",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "The name of the company or organization that services the mortgage loan. This column stores string values and provides information about the entity responsible for managing the loan payments and other related activities.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ServicerType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the type of servicer responsible for managing the mortgage loan. The values in this column are of string data type and provide information about the organization or entity responsible for servicing the loan, such as a bank or mortgage company. This column can be used to track the performance of different types of servicers and their impact on loan status and other metrics.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Specifies the type of loan associated with each property. It stores values of string data type, indicating the type of loan taken by the property owner. This column provides information about the terms and conditions of the loan, such as interest rates and payment schedules.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UnPaidBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The outstanding balance on the mortgage loan for a particular property. This column stores numerical values in double data type, indicating the amount of money that the borrower still owes on their mortgage loan. It is an important metric for lenders to assess the risk associated with a particular loan.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "CurrentPropValue",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "The current market value of the property associated with the mortgage. This column stores numerical values in double data type, indicating the estimated worth of the property at the time of data collection. It provides an insight into the value of the property and its potential for generating revenue.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LoanStatus",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "Indicates the current status of the loan associated with the property. The values in this column are of string data type and provide information on whether the loan is in good standing, delinquent, or in default. This column is important for tracking the overall health of the mortgage portfolio.",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "UPB_to_Value_Ratio",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "z6HBl7WXxR9mCNM8mNMpO$$HMlkZMWonJMQR5h2BVwnj",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "allIns" : false,
        "doPivot" : false,
        "aggregate" : [ {
          "target" : "prop_count",
          "expression" : {
            "format" : "sql",
            "expression" : "count(PropID)"
          },
          "description" : "",
          "_row_id" : "c_13"
        }, {
          "target" : "UPB_to_Value_Ratio",
          "expression" : {
            "format" : "sql",
            "expression" : "avg(UPB_to_Value_Ratio)"
          },
          "description" : "",
          "_row_id" : null
        } ],
        "allowSelection" : true,
        "pivotColumn" : null,
        "pivotValues" : [ ],
        "activeTab" : "aggregate",
        "columnsSelector" : [ "pLOrTpxg_HWt9ZcgX3Ql6$$FUs_v0Y-iO52AOWoViL5H##UPB_to_Value_Ratio", "pLOrTpxg_HWt9ZcgX3Ql6$$FUs_v0Y-iO52AOWoViL5H##State", "pLOrTpxg_HWt9ZcgX3Ql6$$FUs_v0Y-iO52AOWoViL5H##PropID" ],
        "groupBy" : [ {
          "target" : "State",
          "expression" : {
            "format" : "sql",
            "expression" : "State"
          },
          "description" : "",
          "_row_id" : null
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.4&projectSubscriptionProjectId=12654&path=gems/Aggregate",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "zyoB6ezFKyy2O8-m5hJvG$$bIf2_Q-tpYvZTjzMwyryh" : {
      "id" : "zyoB6ezFKyy2O8-m5hJvG$$bIf2_Q-tpYvZTjzMwyryh",
      "component" : "Source",
      "metadata" : {
        "label" : "csv_mortgage_east",
        "slug" : "csv_mortgage_east",
        "x" : 320,
        "y" : 220,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This gem reads in a CSV file containing mortgage data for properties in the eastern region of the United States. It specifies the schema of the data and sets options for reading in the file, such as the header and separator. This data can be used for analysis and modeling to gain insights into the mortgage market in the eastern region."
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "_tUYWfc_JdpLPSS2GrE7y$$qyetxMr4IlCCNTrvkMFq-",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/mortgage_east"
      }
    },
    "4kqI7vslqwZUkg8g5eiyi$$IuxlRqsVksOhU3snnAewR" : {
      "id" : "4kqI7vslqwZUkg8g5eiyi$$IuxlRqsVksOhU3snnAewR",
      "component" : "Source",
      "metadata" : {
        "label" : "csv_mortgage_west",
        "slug" : "csv_mortgage_west",
        "x" : 120,
        "y" : 420,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : false,
        "comment" : "This gem reads in a CSV file containing mortgage data for the western region of the United States. It specifies the schema of the data and sets options for reading in the file. This could be used to load and analyze mortgage data for the western region, providing insights into the housing market and mortgage trends in the area."
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "du2xrdKnRybrrvOjZxmF0$$XxzDtzgsC3ECLIamUQMux",
          "slug" : "out"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/mortgage_west"
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  }
}